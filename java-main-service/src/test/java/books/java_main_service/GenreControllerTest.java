package books.java_main_service;import books.java_main_service.controller.GenreController;import books.java_main_service.model.Genre;import books.java_main_service.service.GenreService;import org.junit.jupiter.api.BeforeEach;import org.junit.jupiter.api.Test;import org.mockito.InjectMocks;import org.mockito.Mock;import org.mockito.MockitoAnnotations;import org.springframework.test.web.servlet.MockMvc;import org.springframework.test.web.servlet.setup.MockMvcBuilders;import org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver;import java.util.Arrays;import java.util.Collections;import java.util.List;import static org.mockito.ArgumentMatchers.eq;import static org.mockito.Mockito.when;import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;class GenreControllerTest {    private MockMvc mockMvc;    @Mock private GenreService genreService;    @InjectMocks private GenreController genreController;    private Genre testGenre;    @BeforeEach    void setUp() {        MockitoAnnotations.openMocks(this);        // Настройка обработчика исключений        ExceptionHandlerExceptionResolver exceptionResolver =                new ExceptionHandlerExceptionResolver();        exceptionResolver.afterPropertiesSet();        mockMvc =                MockMvcBuilders.standaloneSetup(genreController)                        .setHandlerExceptionResolvers(exceptionResolver)                        .build();        // Подготовка тестовых данных        testGenre = new Genre();        testGenre.setId(1L);        testGenre.setName("Фэнтези");        testGenre.setMain(true);    }    @Test    void getAllGenres() throws Exception {        List<Genre> genres = Collections.singletonList(testGenre);        when(genreService.getAllGenres()).thenReturn(genres);        mockMvc.perform(get("/genres"))                .andExpect(status().isOk())                .andExpect(jsonPath("$[0].id").value(testGenre.getId()))                .andExpect(jsonPath("$[0].name").value(testGenre.getName()))                .andExpect(jsonPath("$[0].main").value(testGenre.isMain()));    }    @Test    void searchGenres() throws Exception {        List<Genre> genres = Collections.singletonList(testGenre);        when(genreService.findByNameContaining(eq("Фэнт"))).thenReturn(genres);        mockMvc.perform(get("/genres/search").param("query", "Фэнт"))                .andExpect(status().isOk())                .andExpect(jsonPath("$[0].id").value(testGenre.getId()))                .andExpect(jsonPath("$[0].name").value(testGenre.getName()))                .andExpect(jsonPath("$[0].main").value(testGenre.isMain()));    }}